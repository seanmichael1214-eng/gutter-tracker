<!DOCTYPE html>
<html>
<head>
    <title>Reports - Gutter Crew Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <nav class="navbar">
        <h1>Gutter Crew Tracker</h1>
        <ul>
            <li><a href="/">Dashboard</a></li>
            <li><a href="/customers">Customers</a></li>
            <li><a href="/jobs">Jobs</a></li>
            <li><a href="/inventory">Inventory</a></li>
            <li><a href="/materials">Materials</a></li>
            <li><a href="/reports" class="active">Reports</a></li>
        </ul>
    </nav>

    <div class="container">
        <h2>Reports & Analytics</h2>

        <div class="stats-grid">
            <div class="stat-card">
                <h4>Total Jobs</h4>
                <div class="stat-value">{{ total_jobs }}</div>
            </div>
            <div class="stat-card">
                <h4>Completed Jobs</h4>
                <div class="stat-value">{{ completed_jobs }}</div>
            </div>
            <div class="stat-card">
                <h4>Total Revenue</h4>
                <div class="stat-value">${{ "%.2f"|format(total_revenue) }}</div>
            </div>
            <div class="stat-card">
                <h4>Low Stock Items</h4>
                <div class="stat-value">{{ low_stock_items|length }}</div>
            </div>
        </div>

        {% if low_stock_items %}
        <div class="alert alert-warning">
            <strong>⚠️ Low Stock Alert:</strong> {{ low_stock_items|length }} items need restocking
            <ul style="margin-top: 0.5rem;">
                {% for item in low_stock_items[:5] %}
                <li>{{ item.name }} - {{ item.quantity }} {{ item.unit }} remaining</li>
                {% endfor %}
            </ul>
            <a href="/inventory?low_stock=true" class="btn btn-warning btn-small" style="margin-top: 0.5rem;">View All Low Stock</a>
        </div>
        {% endif %}

        <div class="card">
            <h3>Recent Jobs</h3>
            {% if recent_jobs %}
            <table>
                <thead>
                    <tr>
                        <th>Job</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th>Cost</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for job in recent_jobs %}
                    <tr>
                        <td><a href="/jobs/{{ job.id }}">{{ job.title }}</a></td>
                        <td>{{ job.customer_name }}</td>
                        <td><span class="status-badge status-{{ job.status }}">{{ job.status|replace('_', ' ')|title }}</span></td>
                        <td>${{ "%.2f"|format(job.total_cost) }}</td>
                        <td>{{ job.created[:10] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p style="color: #666;">No jobs yet.</p>
            {% endif %}
        </div>

        <div class="card">
            <h3>Daily Summary</h3>
            <p>Generate end-of-day report for completed jobs</p>
            <button onclick="window.print()" class="btn btn-primary">Print Report</button>
        </div>
    </div>
</body>
</html>
